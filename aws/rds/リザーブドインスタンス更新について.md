# 背景

- RDSのリザーブドインスタンス（RI）は更新ができず、新規購入扱いとなる。
- 同じ条件で再購入したい場合でも、有効期限前後のどちらで購入するかで費用面の差が生じる。

# 今回のモデルケース

- 例として、土曜日の17時にRIの有効期限が切れるケースを想定。
    - 有効期限前の平日営業日、または有効期限後の平日営業日のどちらで購入したほうが良いかを考える。
    - 購入時間は両日とも17時とする（RDSのRIは予約購入ができないため、購入時間は自然と営業時間内に制約される）。

# 料金

## Amazon Aurora MySQL-Compatible db.r6g.large (1ノード)

- オンデマンド料金：
    - 1か月あたり: 228.49 USD
    - 1日あたり（31日計算）: 7.3 USD
    - 1時間あたり: 0.3 USD

- リザーブドインスタンス（前払いなし・1年契約）：
    - 1か月あたり: 150.31 USD
    - 1日あたり: 4.8 USD
    - 1時間あたり: 0.2 USD

- 差額：
    - 1日あたり: 2.5 USD（オンデマンド–RI）
    - 1時間あたり: 0.1 USD

# シナリオ比較

## 有効期限前の平日営業日17時に購入した場合

1. 24時間分のRIが無駄になる。
    - 損失: -2.5 USD

2. オンデマンド料金が発生しなくなる。
    - 対象期間: 土曜日の7時間 + 日曜日の24時間 + 月曜日の17時間
    - 合計利益: +4.8 USD

**結果**: 合計で+2.3 USDの得。

## 有効期限後の平日営業日17時に購入した場合

1. 24時間分のRIが無駄にならない。
    - 利益: +2.5 USD

2. オンデマンド料金が発生する。
    - 対象期間: 土曜日の7時間 + 日曜日の24時間 + 月曜日の17時間
    - 合計損失: -4.8 USD

**結果**: 合計で-2.3 USDの損。

# 結論

- RDSのRIを更新（新規購入）する場合、有効期限前の平日営業日に購入したほうが費用面で有利となる。
- ただし、有効期限までに2日以上残っている場合は、この法則が適用されない可能性がある。
    - 長期休暇中にRIの期限が切れる場合は、計画的な購入が必要。